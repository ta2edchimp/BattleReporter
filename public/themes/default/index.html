{% extends 'base.html' %}

{% set pageTitle = 'Overview' %}

{% block head %}
<style>
table#battleReports-overview a.br-inv-link{text-decoration:none}
table#battleReports-overview a:not(.btn){text-decoration:none}
td.no-break{white-space:nowrap}
@media(max-width:420px){.hidden-xxxs{display:none!important;}}
@media(max-width:640px){.hidden-xxs{display:none!important;}}
</style>
{% endblock %}

{% block content %}
    <h1>{{ BR_OWNER }}'s BattleReports</h1>
    {% if battleList|length == 0 %}
    <div class="panel">
        <div class="panel-body">
            <strong>No Battles</strong> stored in {{ BR_OWNER }}'s BattleReporter yet.
        </div>
    </div>
    {% else %}
    <table id="battleReports-overview" class="panel-body table table-striped table-hover ">
        <tbody>
        {% for battle in battleList %}
            <tr data-battle-report-id="{{ battle.battleReportID }}"{% if battle.published == 0 %} title="BattleReport is unpublished"{% endif %}>
                <td><a href="/show/{{ battle.battleReportID }}" class="br-inv-link">
					{% if battle.published == 0 %}<span class="label label-info">UNPUBLISHED</span>{% endif %}
					{% if battle.title != '' %}{{ battle.title }}{% else %}<em>(Untitled)</em>{% endif %}
					</a></td>
				<td class="no-break hidden-xxs">{{ battle.creatorUserName }}</td>
				{% if BR_COMMENTS_ENABLED == true %}
				<td class="no-break hidden-xs">{% if battle.footageCount > 0 %}<span class="glyphicon glyphicon-facetime-video" title="BattleReport has {{ battle.footageCount }} video{% if battle.footageCount > 1 %}s{% endif %}"></span>{% endif %}</td>
				{% endif %}
				<td class="no-break hidden-xs">{% if battle.commentCount > 0 %}<span class="glyphicon glyphicon-comment" title="BattleReport has {{ battle.commentCount }} comment{% if battle.commentCount > 1 %}s{% endif %}"></span>{% endif %}</td>
                <td class="no-break hidden-xxs">{{ battle.solarSystemName }}</td>
                <td class="no-break">{{ battle.date }}</td>
                <td class="no-break hidden-xxxs text-right">{{ battle.pilotCountTeamA }}</td>
                <td class="no-break hidden-xxxs text-center">:</td>
                <td class="no-break hidden-xxxs text-left">{{ battle.pilotCountTeamB + battle.pilotCountTeamC }}</td>
                {% if battle.efficiency == 1 %}
                    {% set efficiencyClsName = 'text-success' %}
                {% elseif battle.efficiency > 0.5 %}
                    {% set efficiencyClsName = 'text-info' %}
                {% elseif battle.efficiency > 0.1 %}
                    {% set efficiencyClsName = 'text-warning' %}
                {% else %}
                    {% set efficiencyClsName = 'text-danger' %}
                {% endif %}
                <td class="no-break text-right {{ efficiencyClsName }}"><strong>{{ (battle.efficiency * 100)|number_format(2, '.', ',')  }}%</strong></td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% endif %}
{% endblock %}

{% block scripts %}
<script>
    $('*[data-battle-report-id]').each(function () {
        $(this).css({ cursor: 'pointer' });
    }).click(function () {
        var id = $(this).attr('data-battle-report-id');
        if (!id) return;
        window.location.href = '/show/' + id;
    });
</script>
{% endblock %}
